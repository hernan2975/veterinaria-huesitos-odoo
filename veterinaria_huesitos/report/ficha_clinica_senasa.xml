<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_ficha_clinica_senasa">
        <t t-call="web.basic_layout">
            <div class="page">
                <div class="row">
                    <div class="col-3">
                        <img t-att-src="'/logo.png'" style="max-height: 80px;"/>
                    </div>
                    <div class="col-9 text-right">
                        <h2>Veterinaria Huesitos</h2>
                        <p>Guatrache, La Pampa<br/>
                        Tel: +54 2954 123456<br/>
                        huesitos@veterinaria.com.ar</p>
                    </div>
                </div>
                
                <hr/>
                
                <div class="row">
                    <div class="col-6">
                        <h3>FICHA CLÍNICA SENASA</h3>
                        <p><strong>Código:</strong> <span t-field="doc.name"/></p>
                        <p><strong>Fecha:</strong> <span t-field="doc.fecha_atencion" t-options='{"widget": "datetime"}'/></p>
                    </div>
                    <div class="col-6 text-right">
                        <barcode t-field="doc.name" 
                                 t-options='{"width": 200, "height": 50, "human_readable": true}'/>
                    </div>
                </div>
                
                <div class="row mt-3">
                    <div class="col-6">
                        <h4>Datos del Paciente</h4>
                        <p><strong>Nombre:</strong> <span t-field="doc.paciente_id.name"/></p>
                        <p><strong>Especie:</strong> <span t-field="doc.paciente_id.especie"/></p>
                        <p><strong>Raza:</strong> <span t-field="doc.paciente_id.raza"/></p>
                        <p><strong>Sexo:</strong> <span t-field="doc.paciente_id.sexo"/></p>
                        <p><strong>Edad:</strong> <span t-field="doc.paciente_id.edad"/></p>
                        <p><strong>RNAC:</strong> <span t-field="doc.paciente_id.senasa_id"/></p>
                    </div>
                    <div class="col-6">
                        <h4>Datos del Dueño</h4>
                        <p><strong>Nombre:</strong> <span t-field="doc.cliente_id.name"/></p>
                        <p><strong>Teléfono:</strong> <span t-field="doc.cliente_id.telefono"/></p>
                        <p><strong>Dirección:</strong> <span t-field="doc.cliente_id.direccion"/></p>
                        <p><strong>Localidad:</strong> <span t-field="doc.cliente_id.localidad"/></p>
                    </div>
                </div>
                
                <div class="mt-3">
                    <h4>Motivo de Consulta</h4>
                    <p><span t-field="doc.motivo_consulta"/></p>
                    
                    <h4>Diagnóstico</h4>
                    <p><span t-field="doc.diagnostico"/></p>
                    
                    <h4>Medicamentos Utilizados</h4>
                    <t t-if="doc.medicamentos_ids">
                        <ul>
                            <t t-foreach="doc.medicamentos_ids" t-as="med">
                                <li><span t-field="med.name"/> - <span t-field="med.principio_activo"/></li>
                            </t>
                        </ul>
                    </t>
                    <t t-if="doc.dosis_medicamentos">
                        <p><strong>Dosis:</strong> <span t-field="doc.dosis_medicamentos"/></p>
                    </t>
                </div>
                
                <div class="mt-3">
                    <div class="row">
                        <div class="col-4">
                            <p><strong>Matrícula Veterinario:</strong> <span t-field="doc.matricula_veterinario"/></p>
                        </div>
                        <div class="col-4 text-center">
                            <p>--------------------------</p>
                            <p>Firma Veterinario</p>
                        </div>
                        <div class="col-4 text-center">
                            <p>--------------------------</p>
                            <p>Firma Dueño</p>
                        </div>
                    </div>
                </div>
                
                <div class="mt-4 text-center">
                    <p><small>Esta ficha cumple con los requisitos de la Resolución SENASA 332/2022</small></p>
                </div>
            </div>
        </t>
    </template>

    <record id="action_report_ficha_clinica" model="ir.actions.report">
        <field name="name">Ficha Clínica SENASA</field>
        <field name="model">veterinaria_huesitos.historial_clinico</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">veterinaria_huesitos.report_ficha_clinica_senasa</field>
        <field name="report_file">veterinaria_huesitos/report_ficha_clinica_senasa</field>
        <field name="print_report_name">"Ficha_SENASA_%(object.name)s"</field>
    </record>
</odoo>
